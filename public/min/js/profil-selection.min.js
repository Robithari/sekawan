import{doc,getDoc,updateDoc,setDoc}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";import{db}from"../../firebase-config.js";const profilDocId="main";export async function loadProfilContent(){console.log("Function loadProfilContent called");const e=document.getElementById("profilForm");try{console.log("Loading profil content from Firestore...");const t=doc(db,"profil","main"),n=await getDoc(t);if(n.exists()){const t=n.data();if(e){const e=document.getElementById("profilContent"),n=document.getElementById("profil-preview");e&&n&&(e.value=t.content,n.innerHTML=t.content)}}else if(await setDoc(doc(db,"profil","main"),{content:""}),e){const e=document.getElementById("profilContent"),t=document.getElementById("profil-preview");e&&t&&(e.value="",t.innerHTML="")}}catch(e){console.error("Error loading profil content:",e);const t=document.getElementById("profilMessage");t&&(t.innerText="Terjadi kesalahan saat memuat konten profil.",t.className="alert alert-danger")}}export async function saveProfilContent(e){const t=document.getElementById("profilMessage");try{const n=doc(db,"profil","main");await updateDoc(n,{content:e}),t&&(t.innerText="Profil berhasil diperbarui.",t.className="alert alert-success");const o=document.getElementById("profil-preview");o&&(o.innerHTML=e)}catch(e){console.error("Error saving profil content:",e),t&&(t.innerText="Terjadi kesalahan saat menyimpan konten profil.",t.className="alert alert-danger")}}export function setupProfilForm(){const e=document.getElementById("profilForm");if(e){e.addEventListener("submit",async function(e){e.preventDefault();const t=document.getElementById("profilContent"),n=t?t.value:"";await saveProfilContent(n)});const t=document.getElementById("cancel-profil-btn");t&&t.addEventListener("click",async function(){await loadProfilContent();const e=document.getElementById("profilMessage");e&&(e.innerText="",e.className="")});const n=document.getElementById("profilContent");n&&n.addEventListener("input",function(){const e=this.value,t=document.getElementById("profil-preview");t&&(t.innerHTML=e)})}}export async function initializeProfilCMS(){await loadProfilContent(),setupProfilForm()}export async function initializeProfilPublic(){await loadProfilContent()}document.addEventListener("DOMContentLoaded",()=>{console.log("DOM Content Loaded, initializing CMS..."),initializeProfilCMS()});