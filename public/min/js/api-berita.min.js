import{collection,getDocs,query,where}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";import{db}from"../firebase-config.js";const urlParams=new URLSearchParams(window.location.search),slug=urlParams.get("slug");async function loadBerita(){if(slug)try{const e=query(collection(db,"berita"),where("slug","==",slug)),t=await getDocs(e);if(t.empty)document.body.innerHTML="<h1>Berita tidak ditemukan!</h1>";else{const e=t.docs[0].data();document.title=e.title||"Berita tidak tersedia",document.querySelector('meta[property="og:title"]').setAttribute("content",e.title||""),document.querySelector('meta[property="og:description"]').setAttribute("content",e.titleKeterangan||""),document.querySelector('meta[property="og:image"]').setAttribute("content",e.photoUrl||""),document.getElementById("title").innerText=e.title||"Judul tidak tersedia",document.getElementById("titleKeterangan").innerText=e.titleKeterangan||"",document.getElementById("tanggalPembuatan").innerText=new Date(e.tanggalPembuatan).toLocaleDateString("id-ID"),document.getElementById("photoUrl").src=e.photoUrl||"",document.getElementById("photoUrl").alt=e.caption||"",document.getElementById("caption").innerText=e.caption||"";const a=(new DOMParser).parseFromString(e.content||"","text/html").body.innerHTML;document.getElementById("articles").innerHTML=a,setTimeout(()=>{window.dataLayer.push({event:"pageDataLoaded",pagePath:`/berita/${slug}`,pageTitle:e.title}),gtag("event","page_view",{page_title:e.title,page_location:window.location.href})},5e3)}}catch(e){console.error("Gagal memuat berita:",e),document.body.innerHTML="<h1>Terjadi kesalahan saat memuat berita.</h1>"}else document.body.innerHTML="<h1>Slug tidak ditemukan di URL!</h1>"}document.addEventListener("DOMContentLoaded",loadBerita);