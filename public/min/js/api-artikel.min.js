import{collection,getDocs,query,where}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";import{db}from"../firebase-config.js";let slug=window.location.pathname.split("/").pop();if(!slug)throw document.body.innerHTML="<h1>Slug tidak ditemukan di URL!</h1>",new Error("Slug tidak ditemukan di URL.");async function loadArticle(){try{console.log("Mengambil artikel dengan slug:",slug);const t=query(collection(db,"articles"),where("slug","==",slug)),e=await getDocs(t);if(e.empty)console.error("Artikel tidak ditemukan dengan slug:",slug),document.body.innerHTML="<h1>Artikel tidak ditemukan!</h1>";else{const t=e.docs[0].data();document.title=t.title||"Artikel tidak tersedia",document.querySelector('meta[property="og:title"]').setAttribute("content",t.title||""),document.querySelector('meta[property="og:description"]').setAttribute("content",t.titleKeterangan||""),document.querySelector('meta[property="og:image"]').setAttribute("content",t.photoUrl||"");const a=document.getElementById("title"),n=document.getElementById("titleKeterangan"),o=document.getElementById("tanggalPembuatan"),i=document.getElementById("photoUrl"),l=document.getElementById("caption"),r=document.getElementById("articles");if(a&&(a.textContent=t.title||"Tidak ada judul"),n&&(n.textContent=t.titleKeterangan||"Tidak ada keterangan"),o){const e=t.tanggalPembuatan?new Date(1e3*t.tanggalPembuatan.seconds):"Tidak ada tanggal";o.textContent=e.toLocaleDateString("id-ID")}i&&(i.src=t.photoUrl||"placeholder.jpg",i.alt=t.caption||"Gambar tidak tersedia"),l&&(l.textContent=t.caption||"Tidak ada caption"),r&&(r.innerHTML=t.content||"<p>Konten tidak tersedia.</p>"),setTimeout(()=>{window.dataLayer.push({event:"pageDataLoaded",pagePath:`/articles/view/${slug}`,pageTitle:t.title}),gtag("event","page_view",{page_title:t.title,page_location:window.location.href})},5e3)}}catch(t){console.error("Gagal memuat artikel:",t),document.body.innerHTML="<h1>Terjadi kesalahan saat memuat artikel.</h1>"}}document.addEventListener("DOMContentLoaded",loadArticle);